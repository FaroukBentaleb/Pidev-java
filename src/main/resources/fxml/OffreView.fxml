<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.chart.*?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>
<?import javafx.scene.text.*?>
<?import javafx.scene.shape.Circle?>
<?import de.jensd.fx.glyphs.fontawesome.FontAwesomeIconView?>
<?import java.net.URL?>

<BorderPane prefHeight="1280.0" prefWidth="720.0" styleClass="root-pane" xmlns="http://javafx.com/javafx" xmlns:fx="http://javafx.com/fxml" fx:controller="tn.learniverse.controller.OffreController">
    <stylesheets>
        <URL value="@../styles/styles.css"/>
    </stylesheets>
    <!-- LEFT SIDEBAR -->
    <left>
        <ScrollPane fitToWidth="true" styleClass="sidebar-scroll" hbarPolicy="NEVER" vbarPolicy="AS_NEEDED">
            <VBox styleClass="modern-sidebar" spacing="20">
                <!-- App Logo/Name -->
                <VBox styleClass="sidebar-header" alignment="CENTER" spacing="8">
                    <FontAwesomeIconView glyphName="GRADUATION_CAP" size="40" fill="WHITE"/>
                    <Text styleClass="sidebar-title" text="Learniverse"/>
                    <Text styleClass="nav-section-title" text="Admin Dashboard"/>
                </VBox>
                
                <!-- Navigation Section -->
                <VBox styleClass="nav-section" spacing="12">
                    <Text styleClass="nav-section-title" text="MAIN MENU"/>
                    
                    <Button styleClass="nav-button" mnemonicParsing="false">
                        <graphic>
                            <HBox spacing="18" alignment="CENTER_LEFT">
                                <FontAwesomeIconView glyphName="DASHBOARD" fill="WHITE" size="1.7em"/>
                                <Text fill="WHITE" text="Dashboard"/>
                            </HBox>
                        </graphic>
                    </Button>
                    
                    <Button styleClass="nav-button, active" mnemonicParsing="false">
                        <graphic>
                            <HBox spacing="18" alignment="CENTER_LEFT">
                                <FontAwesomeIconView glyphName="TAGS" fill="WHITE" size="1.7em"/>
                                <Text fill="WHITE" text="Offers"/>
                            </HBox>
                        </graphic>
                    </Button>
                    
                    <Button styleClass="nav-button" mnemonicParsing="false">
                        <graphic>
                            <HBox spacing="18" alignment="CENTER_LEFT">
                                <FontAwesomeIconView glyphName="USERS" fill="WHITE" size="1.7em"/>
                                <Text fill="WHITE" text="Subscriptions"/>
                            </HBox>
                        </graphic>
                    </Button>
                </VBox>
                
                <Separator styleClass="separator"/>
                
                <!-- Management Section -->
                <VBox styleClass="nav-section" spacing="12">
                    <Text styleClass="nav-section-title" text="MANAGEMENT"/>
                    
                    <Button styleClass="nav-button" mnemonicParsing="false">
                        <graphic>
                            <HBox spacing="18" alignment="CENTER_LEFT">
                                <FontAwesomeIconView glyphName="COGS" fill="WHITE" size="1.7em"/>
                                <Text fill="WHITE" text="Settings"/>
                            </HBox>
                        </graphic>
                    </Button>
                    
                    <Button styleClass="nav-button" mnemonicParsing="false">
                        <graphic>
                            <HBox spacing="18" alignment="CENTER_LEFT">
                                <FontAwesomeIconView glyphName="LINE_CHART" fill="WHITE" size="1.7em"/>
                                <Text fill="WHITE" text="Analytics"/>
                            </HBox>
                        </graphic>
                    </Button>
                    
                    <Button styleClass="nav-button" mnemonicParsing="false">
                        <graphic>
                            <HBox spacing="18" alignment="CENTER_LEFT">
                                <FontAwesomeIconView glyphName="BELL" fill="WHITE" size="1.7em"/>
                                <Text fill="WHITE" text="Notifications"/>
                            </HBox>
                        </graphic>
                    </Button>
                </VBox>
                
                <Region VBox.vgrow="ALWAYS" minHeight="20"/>
                
                <!-- Profile Section -->
                <VBox styleClass="profile-section" spacing="15">
                    <HBox styleClass="modern-profile-section" alignment="CENTER_LEFT" spacing="15">
                        <StackPane styleClass="profile-avatar">
                            <Text styleClass="profile-initial" text="A"/>
                        </StackPane>
                        <VBox spacing="5">
                            <Text styleClass="profile-name" text="Admin"/>
                            <Text styleClass="profile-role" text="Administrator"/>
                        </VBox>
                    </HBox>
                </VBox>
            </VBox>
            <padding>
                <Insets bottom="20"/>
            </padding>
        </ScrollPane>
    </left>

    <center>
        <ScrollPane fitToWidth="true" styleClass="main-scroll-pane">
            <VBox spacing="25" styleClass="main-content">
                <padding>
                    <Insets top="25" right="35" bottom="25" left="35"/>
                </padding>

                <!-- TOP BAR -->
                <HBox alignment="CENTER" prefHeight="60.0" styleClass="top-bar" spacing="20">
                    <padding>
                        <Insets top="10" right="20" bottom="10" left="20"/>
                    </padding>
                    
                    <Label styleClass="page-title" text="Offer Management" style="-fx-font-size: 24px; -fx-font-weight: bold; -fx-text-fill: #1a237e;"/>
                    <HBox HBox.hgrow="ALWAYS" />

                    <!-- Search Area -->
                    <HBox alignment="CENTER" styleClass="modern-search-box" maxWidth="300">
                        <padding>
                            <Insets top="8" right="15" bottom="8" left="15"/>
                        </padding>
                        <FontAwesomeIconView glyphName="SEARCH" fill="#9e9e9e" size="14"/>
                        <TextField fx:id="searchField" promptText="Search offers..." style="-fx-background-color: transparent; -fx-font-size: 13px;">
                            <HBox.margin>
                                <Insets left="10"/>
                            </HBox.margin>
                        </TextField>
                    </HBox>

                    <!-- New Offer Button -->
                    <Button fx:id="addButton" styleClass="new-offer-button">
                        <graphic>
                            <HBox alignment="CENTER" spacing="8">
                                <StackPane styleClass="plus-icon-container">
                                    <FontAwesomeIconView glyphName="PLUS" styleClass="plus-icon"/>
                                </StackPane>
                                <Label text="New Offer" styleClass="button-text"/>
                            </HBox>
                        </graphic>
                    </Button>
                </HBox>

                <!-- Statistics Panel -->
                <HBox spacing="15" styleClass="stats-panel">
                    <padding>
                        <Insets top="10" right="10" bottom="10" left="10"/>
                    </padding>
                    <VBox styleClass="stat-card" alignment="CENTER" spacing="5" HBox.hgrow="ALWAYS">
                        <padding>
                            <Insets top="15" right="15" bottom="15" left="15"/>
                        </padding>
                        <FontAwesomeIconView glyphName="CUBE" fill="#1a237e" size="24"/>
                        <Text text="Total Offers" styleClass="stat-label" style="-fx-font-size: 14px; -fx-fill: #757575;"/>
                        <Text fx:id="totalOffersText" text="0" styleClass="stat-value" style="-fx-font-size: 24px; -fx-font-weight: bold; -fx-fill: #1a237e;"/>
                    </VBox>
                    <VBox styleClass="stat-card" alignment="CENTER" spacing="5" HBox.hgrow="ALWAYS">
                        <padding>
                            <Insets top="15" right="15" bottom="15" left="15"/>
                        </padding>
                        <FontAwesomeIconView glyphName="CHECK_CIRCLE" fill="#1a237e" size="24"/>
                        <Text text="Active Offers" styleClass="stat-label" style="-fx-font-size: 14px; -fx-fill: #757575;"/>
                        <Text fx:id="activeOffersText" text="0" styleClass="stat-value" style="-fx-font-size: 24px; -fx-font-weight: bold; -fx-fill: #1a237e;"/>
                    </VBox>
                    <VBox styleClass="stat-card" alignment="CENTER" spacing="5" HBox.hgrow="ALWAYS">
                        <padding>
                            <Insets top="15" right="15" bottom="15" left="15"/>
                        </padding>
                        <FontAwesomeIconView glyphName="DOLLAR" fill="#1a237e" size="24"/>
                        <Text text="Average Price" styleClass="stat-label" style="-fx-font-size: 14px; -fx-fill: #757575;"/>
                        <Text fx:id="avgPriceText" text="0" styleClass="stat-value" style="-fx-font-size: 24px; -fx-font-weight: bold; -fx-fill: #1a237e;"/>
                    </VBox>
                    <VBox styleClass="stat-card" alignment="CENTER" spacing="5" HBox.hgrow="ALWAYS">
                        <padding>
                            <Insets top="15" right="15" bottom="15" left="15"/>
                        </padding>
                        <FontAwesomeIconView glyphName="USERS" fill="#1a237e" size="24"/>
                        <Text text="Total Subscriptions" styleClass="stat-label" style="-fx-font-size: 14px; -fx-fill: #757575;"/>
                        <Text fx:id="totalSubscriptionsText" text="0" styleClass="stat-value" style="-fx-font-size: 24px; -fx-font-weight: bold; -fx-fill: #1a237e;"/>
                    </VBox>
                    <style>
                        -fx-background-color: #f5f5f5;
                        -fx-background-radius: 8;
                    </style>
                </HBox>

                <!-- Charts Section -->
                <HBox spacing="20" styleClass="charts-container">
                    <VBox styleClass="chart-card" HBox.hgrow="ALWAYS">
                        <Text text="Offer Distribution" styleClass="chart-title"/>
                        <PieChart fx:id="statusDistributionChart" styleClass="mini-chart"/>
                        <Button onAction="#handleExportPieChart" styleClass="modern-button, chart-export-button">
                            <graphic>
                                <HBox alignment="CENTER" spacing="8">
                                    <StackPane styleClass="icon-container">
                                        <FontAwesomeIconView glyphName="DOWNLOAD" styleClass="button-icon"/>
                                    </StackPane>
                                    <Label text="Export" styleClass="button-text"/>
                                </HBox>
                            </graphic>
                        </Button>
                    </VBox>
                    <VBox styleClass="chart-card" HBox.hgrow="ALWAYS">
                        <Text text="Price Trends" styleClass="chart-title"/>
                        <LineChart fx:id="priceTrendsChart" styleClass="mini-chart">
                            <xAxis>
                                <CategoryAxis fx:id="priceTrendsXAxis" label="Month"/>
                            </xAxis>
                            <yAxis>
                                <NumberAxis fx:id="priceTrendsYAxis" label="Price ($)"/>
                            </yAxis>
                        </LineChart>
                        <Button onAction="#handleExportLineChart" styleClass="modern-button, chart-export-button">
                            <graphic>
                                <HBox alignment="CENTER" spacing="8">
                                    <StackPane styleClass="icon-container">
                                        <FontAwesomeIconView glyphName="DOWNLOAD" styleClass="button-icon"/>
                                    </StackPane>
                                    <Label text="Export" styleClass="button-text"/>
                                </HBox>
                            </graphic>
                        </Button>
                    </VBox>
                </HBox>

                <!-- Export Controls -->
                <HBox alignment="CENTER_RIGHT" spacing="15" styleClass="export-controls">
                    <Button onAction="#handleExportCSV" styleClass="modern-button, export-button">
                        <graphic>
                            <HBox alignment="CENTER" spacing="8">
                                <StackPane styleClass="icon-container">
                                    <FontAwesomeIconView glyphName="FILE_TEXT" styleClass="button-icon"/>
                                </StackPane>
                                <Label text="Export CSV" styleClass="button-text"/>
                            </HBox>
                        </graphic>
                    </Button>
                    <Button onAction="#handleExportExcel" styleClass="modern-button, export-button">
                        <graphic>
                            <HBox alignment="CENTER" spacing="8">
                                <StackPane styleClass="icon-container">
                                    <FontAwesomeIconView glyphName="FILE_EXCEL" styleClass="button-icon"/>
                                </StackPane>
                                <Label text="Export Excel" styleClass="button-text"/>
                            </HBox>
                        </graphic>
                    </Button>
                    <Button onAction="#handleExportPDF" styleClass="modern-button, export-button">
                        <graphic>
                            <HBox alignment="CENTER" spacing="8">
                                <StackPane styleClass="icon-container">
                                    <FontAwesomeIconView glyphName="FILE_PDF" styleClass="button-icon"/>
                                </StackPane>
                                <Label text="Export PDF" styleClass="button-text"/>
                            </HBox>
                        </graphic>
                    </Button>
                </HBox>

                <!-- Filter Controls -->
                <HBox spacing="15" alignment="CENTER_LEFT" styleClass="filter-bar">
                    <ComboBox fx:id="filterStatus" promptText="Status" styleClass="filter-combo"/>
                    <ComboBox fx:id="sortBy" promptText="Sort by" styleClass="filter-combo"/>
                    <ComboBox fx:id="itemsPerPage" promptText="Show" styleClass="filter-combo"/>
                    <Region HBox.hgrow="ALWAYS"/>
                    <Button fx:id="refreshButton" styleClass="modern-button, refresh-button">
                        <graphic>
                            <HBox alignment="CENTER" spacing="8">
                                <StackPane styleClass="icon-container">
                                    <FontAwesomeIconView glyphName="REFRESH" styleClass="button-icon"/>
                                </StackPane>
                                <Label text="Refresh" styleClass="button-text"/>
                            </HBox>
                        </graphic>
                    </Button>
                </HBox>

                <!-- Cards Container -->
                <FlowPane fx:id="cardsContainer" hgap="25" vgap="25" styleClass="cards-container">
                    <!-- Example of a single offer card -->
                    <VBox styleClass="offer-card">
                        <HBox alignment="CENTER_LEFT" spacing="10">
                            <Label styleClass="offer-title" text="Offre Basic"/>
                            <Region HBox.hgrow="ALWAYS"/>
                            <Label styleClass="status-badge,status-active" text="ACTIVE"/>
                        </HBox>
                        
                        <HBox alignment="CENTER_LEFT" spacing="10">
                            <Label styleClass="offer-price" text="49,99$"/>
                            <Label styleClass="per-month" text="per month"/>
                            <Label styleClass="discount-badge" text="-5%"/>
                        </HBox>
                        
                        <Label styleClass="offer-description" text="Un abonnement pour débutants."/>
                        
                        <Region VBox.vgrow="ALWAYS"/>
                        
                        <VBox styleClass="button-container">
                            <HBox spacing="10" alignment="CENTER">
                                <Button styleClass="edit-button" text="Edit"/>
                                <Button styleClass="delete-button" text="Delete"/>
                            </HBox>
                            <Button styleClass="email-button" text="Email"/>
                        </VBox>
                    </VBox>
                </FlowPane>

                <!-- Pagination -->
                <HBox alignment="CENTER" spacing="20" styleClass="pagination-container">
                    <Text fx:id="paginationInfo" styleClass="pagination-info"/>
                    <Region HBox.hgrow="ALWAYS"/>
                    <HBox alignment="CENTER" spacing="8" styleClass="pagination-controls">
                        <Button fx:id="prevPageButton" styleClass="pagination-button">
                            <graphic>
                                <FontAwesomeIconView glyphName="CHEVRON_LEFT" fill="#1a237e" size="1.2em"/>
                            </graphic>
                        </Button>
                        <TextField fx:id="jumpToPageField" promptText="Page" styleClass="page-input"/>
                        <Text text="/" styleClass="pagination-text"/>
                        <Text fx:id="totalPagesText" text="0" styleClass="pagination-text"/>
                        <Button fx:id="nextPageButton" styleClass="pagination-button">
                            <graphic>
                                <FontAwesomeIconView glyphName="CHEVRON_RIGHT" fill="#1a237e" size="1.2em"/>
                            </graphic>
                        </Button>
                    </HBox>
                </HBox>
            </VBox>
        </ScrollPane>
    </center>
</BorderPane> 